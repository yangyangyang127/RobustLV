import math 
import torch
from torch.autograd import Variable
import numpy as np

def L( r ):
    if r <= math.pi / 4:
        return 2
    elif r >= math.pi / 2:
        return 0
    else:
        return 2 * math.cos( math.pi / 2 * math.log( 4 * r / math.pi ) / math.log( 2 ) )

def H( r ):
    if   r <= math.pi / 4:
        return 0
    elif r >= math.pi / 2:
        return 1
    else:
        return math.cos( math.pi / 2 * math.log( 2 * r / math.pi ) / math.log( 2 ) )

def G( t, k, K ):
    t0 = math.pi * k / K
    aK = 2**(K-1) * math.factorial(K-1) / math.sqrt( K * math.factorial( 2 * (K-1) ) )

    if (t - t0) > (math.pi/2):
        return G( t - math.pi, k, K )
    elif (t - t0 ) < (-math.pi/2):
        return G( t + math.pi, k, K )
    else:
        return aK * (math.cos( t - t0 ))**(K-1)

def S( t, k, K ):
	t0 = math.pi * k / K 
	dt = abs(t-t0)

	if   dt <  math.pi/2:
		return 1 
	elif dt == math.pi/2:
		return 0
	else:
		return -1 

def L0( r ):
	return L( r/2 ) / 2 

def H0( r ):
	return H( r/2 )

def polar_map( s ):
	x = torch.linspace( 0, math.pi, s[1] ).view( 1, s[1] ).expand( s )
	if s[0] % 2 == 0 :
		y = torch.linspace( -math.pi, math.pi, s[0]+1 ).narrow(0,1,s[0])
	else:
		y = torch.linspace( -math.pi, math.pi, s[0] )
	y = y.view( s[0], 1 ).expand( s ).mul( -1 )
	r = ( x**2 + y**2 ).sqrt()
	t = torch.atan2( y, x )

	return r, t 

def S_matrix( K, s ):
	_, t = polar_map( s )
	sm = torch.Tensor( K, s[0], s[1] )

	for k in range( K ):
		for i in range( s[0] ):
			for j in range( s[1] ):
				sm[k][i][j] = S( t[i][j], k, K )
	return sm 

def G_matrix( K, s ):
	_, t = polar_map( s ) 
	g = torch.Tensor( K, s[0], s[1] )
	for k in range( K ):
		for i in range( s[0] ):
			for j in range( s[1] ):
				g[k][i][j] = G( t[i][j], k, K )
	return g 

def B_matrix( K, s ):
	g = G_matrix( K, s )
	r, _ = polar_map( s )
	h = r.apply_( H ).unsqueeze(0)

	return h * g 

def L_matrix( s ):

	r, _ = polar_map( s )

	return r.apply_( L )

def LB_matrix( K, s ):
	l = L_matrix( s ).unsqueeze(0) 
	b = B_matrix( K, s ) 

	return torch.cat( (l,b), 0 )

def HL0_matrix( s ):
	r, _ = polar_map( s )
	h = r.clone().apply_( H0 ).view( 1, s[0], s[1] ) 
	l = r.clone().apply_( L0 ).view( 1, s[0], s[1] )

	return torch.cat( ( h, l ), 0 )

def central_crop( x ):
	ns = [ x.size(-2)//2 , x.size(-1)//2 + 1 ]
	return x.narrow( -2, ns[1]-1, ns[0] ).narrow( -1, 0, ns[1] )

def cropped_size( s ):

	return [ s[0]//2 , s[1]//2 + 1 ]

def L_matrix_cropped( s ):

	l = L_matrix( s ) 

	ns = cropped_size( s ) 

	return l.narrow( 0, ns[1]-1, ns[0] ).narrow( 1, 0, ns[1] ) 

def freq_shift( imgSize, fwd, device ):
    ind = torch.LongTensor( imgSize ).to(device)
    sgn = 1 
    if fwd:
        sgn = -1 
    for i in range( imgSize ):
        ind[i] = (i + sgn*((imgSize-1)//2) ) % imgSize

    return Variable( ind ) 

##########
def sp5_filters():
    filters = {}
    filters['harmonics'] = np.array([1, 3, 5])
    filters['mtx'] = (
        np.array([[0.3333, 0.2887, 0.1667, 0.0000, -0.1667, -0.2887],
                  [0.0000, 0.1667, 0.2887, 0.3333, 0.2887, 0.1667],
                  [0.3333, -0.0000, -0.3333, -0.0000, 0.3333, -0.0000],
                  [0.0000, 0.3333, 0.0000, -0.3333, 0.0000, 0.3333],
                  [0.3333, -0.2887, 0.1667, -0.0000, -0.1667, 0.2887],
                  [-0.0000, 0.1667, -0.2887, 0.3333, -0.2887, 0.1667]]))
    filters['hi0filt'] = (
        np.array([[-0.00033429, -0.00113093, -0.00171484,
                   -0.00133542, -0.00080639, -0.00133542,
                   -0.00171484, -0.00113093, -0.00033429],
                  [-0.00113093, -0.00350017, -0.00243812,
                   0.00631653, 0.01261227, 0.00631653,
                   -0.00243812, -0.00350017, -0.00113093],
                  [-0.00171484, -0.00243812, -0.00290081,
                   -0.00673482, -0.00981051, -0.00673482,
                   -0.00290081, -0.00243812, -0.00171484],
                  [-0.00133542, 0.00631653, -0.00673482,
                   -0.07027679, -0.11435863, -0.07027679,
                   -0.00673482, 0.00631653, -0.00133542],
                  [-0.00080639, 0.01261227, -0.00981051,
                   -0.11435863, 0.81380200, -0.11435863,
                   -0.00981051, 0.01261227, -0.00080639],
                  [-0.00133542, 0.00631653, -0.00673482,
                   -0.07027679, -0.11435863, -0.07027679,
                   -0.00673482, 0.00631653, -0.00133542],
                  [-0.00171484, -0.00243812, -0.00290081,
                   -0.00673482, -0.00981051, -0.00673482,
                   -0.00290081, -0.00243812, -0.00171484],
                  [-0.00113093, -0.00350017, -0.00243812,
                   0.00631653, 0.01261227, 0.00631653,
                   -0.00243812, -0.00350017, -0.00113093],
                  [-0.00033429, -0.00113093, -0.00171484,
                   -0.00133542, -0.00080639, -0.00133542,
                   -0.00171484, -0.00113093, -0.00033429]]))
    filters['lo0filt'] = (
        np.array([[0.00341614, -0.01551246, -0.03848215, -0.01551246,
                  0.00341614],
                 [-0.01551246, 0.05586982, 0.15925570, 0.05586982,
                  -0.01551246],
                 [-0.03848215, 0.15925570, 0.40304148, 0.15925570,
                  -0.03848215],
                 [-0.01551246, 0.05586982, 0.15925570, 0.05586982,
                  -0.01551246],
                 [0.00341614, -0.01551246, -0.03848215, -0.01551246,
                  0.00341614]]))
    filters['lofilt'] = (
        2 * np.array([[0.00085404, -0.00244917, -0.00387812, -0.00944432,
                       -0.00962054, -0.00944432, -0.00387812, -0.00244917,
                       0.00085404],
                      [-0.00244917, -0.00523281, -0.00661117, 0.00410600,
                       0.01002988, 0.00410600, -0.00661117, -0.00523281,
                       -0.00244917],
                      [-0.00387812, -0.00661117, 0.01396746, 0.03277038,
                       0.03981393, 0.03277038, 0.01396746, -0.00661117,
                       -0.00387812],
                      [-0.00944432, 0.00410600, 0.03277038, 0.06426333,
                       0.08169618, 0.06426333, 0.03277038, 0.00410600,
                       -0.00944432],
                      [-0.00962054, 0.01002988, 0.03981393, 0.08169618,
                       0.10096540, 0.08169618, 0.03981393, 0.01002988,
                       -0.00962054],
                      [-0.00944432, 0.00410600, 0.03277038, 0.06426333,
                       0.08169618, 0.06426333, 0.03277038, 0.00410600,
                       -0.00944432],
                      [-0.00387812, -0.00661117, 0.01396746, 0.03277038,
                       0.03981393, 0.03277038, 0.01396746, -0.00661117,
                       -0.00387812],
                      [-0.00244917, -0.00523281, -0.00661117, 0.00410600,
                       0.01002988, 0.00410600, -0.00661117, -0.00523281,
                       -0.00244917],
                      [0.00085404, -0.00244917, -0.00387812, -0.00944432,
                       -0.00962054, -0.00944432, -0.00387812, -0.00244917,
                       0.00085404]]))
    filters['bfilts'] = (
        np.array([[0.00277643, 0.00496194, 0.01026699, 0.01455399, 0.01026699,
                   0.00496194, 0.00277643, -0.00986904, -0.00893064,
                   0.01189859, 0.02755155, 0.01189859, -0.00893064,
                   -0.00986904, -0.01021852, -0.03075356, -0.08226445,
                   -0.11732297, -0.08226445, -0.03075356, -0.01021852,
                   0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,
                   0.00000000, 0.00000000, 0.01021852, 0.03075356, 0.08226445,
                   0.11732297, 0.08226445, 0.03075356, 0.01021852, 0.00986904,
                   0.00893064, -0.01189859, -0.02755155, -0.01189859,
                   0.00893064, 0.00986904, -0.00277643, -0.00496194,
                   -0.01026699, -0.01455399, -0.01026699, -0.00496194,
                   -0.00277643],
                  [-0.00343249, -0.00640815, -0.00073141, 0.01124321,
                   0.00182078, 0.00285723, 0.01166982, -0.00358461,
                   -0.01977507, -0.04084211, -0.00228219, 0.03930573,
                   0.01161195, 0.00128000, 0.01047717, 0.01486305,
                   -0.04819057, -0.12227230, -0.05394139, 0.00853965,
                   -0.00459034, 0.00790407, 0.04435647, 0.09454202,
                   -0.00000000, -0.09454202, -0.04435647, -0.00790407,
                   0.00459034, -0.00853965, 0.05394139, 0.12227230,
                   0.04819057, -0.01486305, -0.01047717, -0.00128000,
                   -0.01161195, -0.03930573, 0.00228219, 0.04084211,
                   0.01977507, 0.00358461, -0.01166982, -0.00285723,
                   -0.00182078, -0.01124321, 0.00073141, 0.00640815,
                   0.00343249],
                  [0.00343249, 0.00358461, -0.01047717, -0.00790407,
                   -0.00459034, 0.00128000, 0.01166982, 0.00640815,
                   0.01977507, -0.01486305, -0.04435647, 0.00853965,
                   0.01161195, 0.00285723, 0.00073141, 0.04084211, 0.04819057,
                   -0.09454202, -0.05394139, 0.03930573, 0.00182078,
                   -0.01124321, 0.00228219, 0.12227230, -0.00000000,
                   -0.12227230, -0.00228219, 0.01124321, -0.00182078,
                   -0.03930573, 0.05394139, 0.09454202, -0.04819057,
                   -0.04084211, -0.00073141, -0.00285723, -0.01161195,
                   -0.00853965, 0.04435647, 0.01486305, -0.01977507,
                   -0.00640815, -0.01166982, -0.00128000, 0.00459034,
                   0.00790407, 0.01047717, -0.00358461, -0.00343249],
                  [-0.00277643, 0.00986904, 0.01021852, -0.00000000,
                   -0.01021852, -0.00986904, 0.00277643, -0.00496194,
                   0.00893064, 0.03075356, -0.00000000, -0.03075356,
                   -0.00893064, 0.00496194, -0.01026699, -0.01189859,
                   0.08226445, -0.00000000, -0.08226445, 0.01189859,
                   0.01026699, -0.01455399, -0.02755155, 0.11732297,
                   -0.00000000, -0.11732297, 0.02755155, 0.01455399,
                   -0.01026699, -0.01189859, 0.08226445, -0.00000000,
                   -0.08226445, 0.01189859, 0.01026699, -0.00496194,
                   0.00893064, 0.03075356, -0.00000000, -0.03075356,
                   -0.00893064, 0.00496194, -0.00277643, 0.00986904,
                   0.01021852, -0.00000000, -0.01021852, -0.00986904,
                   0.00277643],
                  [-0.01166982, -0.00128000, 0.00459034, 0.00790407,
                   0.01047717, -0.00358461, -0.00343249, -0.00285723,
                   -0.01161195, -0.00853965, 0.04435647, 0.01486305,
                   -0.01977507, -0.00640815, -0.00182078, -0.03930573,
                   0.05394139, 0.09454202, -0.04819057, -0.04084211,
                   -0.00073141, -0.01124321, 0.00228219, 0.12227230,
                   -0.00000000, -0.12227230, -0.00228219, 0.01124321,
                   0.00073141, 0.04084211, 0.04819057, -0.09454202,
                   -0.05394139, 0.03930573, 0.00182078, 0.00640815,
                   0.01977507, -0.01486305, -0.04435647, 0.00853965,
                   0.01161195, 0.00285723, 0.00343249, 0.00358461,
                   -0.01047717, -0.00790407, -0.00459034, 0.00128000,
                   0.01166982],
                  [-0.01166982, -0.00285723, -0.00182078, -0.01124321,
                   0.00073141, 0.00640815, 0.00343249, -0.00128000,
                   -0.01161195, -0.03930573, 0.00228219, 0.04084211,
                   0.01977507, 0.00358461, 0.00459034, -0.00853965,
                   0.05394139, 0.12227230, 0.04819057, -0.01486305,
                   -0.01047717, 0.00790407, 0.04435647, 0.09454202,
                   -0.00000000, -0.09454202, -0.04435647, -0.00790407,
                   0.01047717, 0.01486305, -0.04819057, -0.12227230,
                   -0.05394139, 0.00853965, -0.00459034, -0.00358461,
                   -0.01977507, -0.04084211, -0.00228219, 0.03930573,
                   0.01161195, 0.00128000, -0.00343249, -0.00640815,
                   -0.00073141, 0.01124321, 0.00182078, 0.00285723,
                   0.01166982]]).T)
    return filters    

def sp3_filters():
    filters = {}
    filters['harmonics'] = np.array([1, 3])
    filters['mtx'] = (
        np.array([[0.5000, 0.3536, 0, -0.3536],
                  [-0.0000, 0.3536, 0.5000, 0.3536],
                  [0.5000, -0.3536, 0, 0.3536],
                  [-0.0000, 0.3536, -0.5000, 0.3536]]))
    filters['hi0filt'] = (
        np.array([[-4.0483998600e-4, -6.2596000498e-4, -3.7829999201e-5, 8.8387000142e-4, 1.5450799838e-3, 1.9235999789e-3, 2.0687500946e-3, 2.0898699295e-3, 2.0687500946e-3, 1.9235999789e-3, 1.5450799838e-3, 8.8387000142e-4, -3.7829999201e-5, -6.2596000498e-4, -4.0483998600e-4],
                    [-6.2596000498e-4, -3.2734998967e-4, 7.7435001731e-4, 1.5874400269e-3, 2.1750701126e-3, 2.5626500137e-3, 2.2892199922e-3, 1.9755100366e-3, 2.2892199922e-3, 2.5626500137e-3, 2.1750701126e-3, 1.5874400269e-3, 7.7435001731e-4, -3.2734998967e-4, -6.2596000498e-4],
                    [-3.7829999201e-5, 7.7435001731e-4, 1.1793200392e-3, 1.4050999889e-3, 2.2253401112e-3, 2.1145299543e-3, 3.3578000148e-4, -8.3368999185e-4, 3.3578000148e-4, 2.1145299543e-3, 2.2253401112e-3, 1.4050999889e-3, 1.1793200392e-3, 7.7435001731e-4, -3.7829999201e-5],
                    [8.8387000142e-4, 1.5874400269e-3, 1.4050999889e-3, 1.2960999738e-3, -4.9274001503e-4, -3.1295299996e-3, -4.5751798898e-3, -5.1014497876e-3, -4.5751798898e-3, -3.1295299996e-3, -4.9274001503e-4, 1.2960999738e-3, 1.4050999889e-3, 1.5874400269e-3, 8.8387000142e-4],
                    [1.5450799838e-3, 2.1750701126e-3, 2.2253401112e-3, -4.9274001503e-4, -6.3222697936e-3, -2.7556000277e-3, 5.3632198833e-3, 7.3032598011e-3, 5.3632198833e-3, -2.7556000277e-3, -6.3222697936e-3, -4.9274001503e-4, 2.2253401112e-3, 2.1750701126e-3, 1.5450799838e-3],
                    [1.9235999789e-3, 2.5626500137e-3, 2.1145299543e-3, -3.1295299996e-3, -2.7556000277e-3, 1.3962360099e-2, 7.8046298586e-3, -9.3812197447e-3, 7.8046298586e-3, 1.3962360099e-2, -2.7556000277e-3, -3.1295299996e-3, 2.1145299543e-3, 2.5626500137e-3, 1.9235999789e-3],
                    [2.0687500946e-3, 2.2892199922e-3, 3.3578000148e-4, -4.5751798898e-3, 5.3632198833e-3, 7.8046298586e-3, -7.9501636326e-2, -0.1554141641, -7.9501636326e-2, 7.8046298586e-3, 5.3632198833e-3, -4.5751798898e-3, 3.3578000148e-4, 2.2892199922e-3, 2.0687500946e-3],
                    [2.0898699295e-3, 1.9755100366e-3, -8.3368999185e-4, -5.1014497876e-3, 7.3032598011e-3, -9.3812197447e-3, -0.1554141641, 0.7303866148, -0.1554141641, -9.3812197447e-3, 7.3032598011e-3, -5.1014497876e-3, -8.3368999185e-4, 1.9755100366e-3, 2.0898699295e-3],
                    [2.0687500946e-3, 2.2892199922e-3, 3.3578000148e-4, -4.5751798898e-3, 5.3632198833e-3, 7.8046298586e-3, -7.9501636326e-2, -0.1554141641, -7.9501636326e-2, 7.8046298586e-3, 5.3632198833e-3, -4.5751798898e-3, 3.3578000148e-4, 2.2892199922e-3, 2.0687500946e-3],
                    [1.9235999789e-3, 2.5626500137e-3, 2.1145299543e-3, -3.1295299996e-3, -2.7556000277e-3, 1.3962360099e-2, 7.8046298586e-3, -9.3812197447e-3, 7.8046298586e-3, 1.3962360099e-2, -2.7556000277e-3, -3.1295299996e-3, 2.1145299543e-3, 2.5626500137e-3, 1.9235999789e-3],
                    [1.5450799838e-3, 2.1750701126e-3, 2.2253401112e-3, -4.9274001503e-4, -6.3222697936e-3, -2.7556000277e-3, 5.3632198833e-3, 7.3032598011e-3, 5.3632198833e-3, -2.7556000277e-3, -6.3222697936e-3, -4.9274001503e-4, 2.2253401112e-3, 2.1750701126e-3, 1.5450799838e-3],
                    [8.8387000142e-4, 1.5874400269e-3, 1.4050999889e-3, 1.2960999738e-3, -4.9274001503e-4, -3.1295299996e-3, -4.5751798898e-3, -5.1014497876e-3, -4.5751798898e-3, -3.1295299996e-3, -4.9274001503e-4, 1.2960999738e-3, 1.4050999889e-3, 1.5874400269e-3, 8.8387000142e-4],
                    [-3.7829999201e-5, 7.7435001731e-4, 1.1793200392e-3, 1.4050999889e-3, 2.2253401112e-3, 2.1145299543e-3, 3.3578000148e-4, -8.3368999185e-4, 3.3578000148e-4, 2.1145299543e-3, 2.2253401112e-3, 1.4050999889e-3, 1.1793200392e-3, 7.7435001731e-4, -3.7829999201e-5],
                    [-6.2596000498e-4, -3.2734998967e-4, 7.7435001731e-4, 1.5874400269e-3, 2.1750701126e-3, 2.5626500137e-3, 2.2892199922e-3, 1.9755100366e-3, 2.2892199922e-3, 2.5626500137e-3, 2.1750701126e-3, 1.5874400269e-3, 7.7435001731e-4, -3.2734998967e-4, -6.2596000498e-4],
                    [-4.0483998600e-4, -6.2596000498e-4, -3.7829999201e-5, 8.8387000142e-4, 1.5450799838e-3, 1.9235999789e-3, 2.0687500946e-3, 2.0898699295e-3, 2.0687500946e-3, 1.9235999789e-3, 1.5450799838e-3, 8.8387000142e-4, -3.7829999201e-5, -6.2596000498e-4, -4.0483998600e-4]]))
    filters['lo0filt'] = (
        np.array([[-8.7009997515e-5, -1.3542800443e-3, -1.6012600390e-3, -5.0337001448e-4, 2.5240099058e-3, -5.0337001448e-4, -1.6012600390e-3, -1.3542800443e-3, -8.7009997515e-5],
                [-1.3542800443e-3, 2.9215801042e-3, 7.5227199122e-3, 8.2244202495e-3, 1.1076199589e-3, 8.2244202495e-3, 7.5227199122e-3, 2.9215801042e-3, -1.3542800443e-3],
                [-1.6012600390e-3, 7.5227199122e-3, -7.0612900890e-3, -3.7694871426e-2, -3.2971370965e-2, -3.7694871426e-2, -7.0612900890e-3, 7.5227199122e-3, -1.6012600390e-3],
                [-5.0337001448e-4, 8.2244202495e-3, -3.7694871426e-2, 4.3813198805e-2, 0.1811603010, 4.3813198805e-2, -3.7694871426e-2, 8.2244202495e-3, -5.0337001448e-4],
                [2.5240099058e-3, 1.1076199589e-3, -3.2971370965e-2, 0.1811603010, 0.4376249909, 0.1811603010, -3.2971370965e-2, 1.1076199589e-3, 2.5240099058e-3],
                [-5.0337001448e-4, 8.2244202495e-3, -3.7694871426e-2, 4.3813198805e-2, 0.1811603010, 4.3813198805e-2, -3.7694871426e-2, 8.2244202495e-3, -5.0337001448e-4],
                [-1.6012600390e-3, 7.5227199122e-3, -7.0612900890e-3, -3.7694871426e-2, -3.2971370965e-2, -3.7694871426e-2, -7.0612900890e-3, 7.5227199122e-3, -1.6012600390e-3],
                [-1.3542800443e-3, 2.9215801042e-3, 7.5227199122e-3, 8.2244202495e-3, 1.1076199589e-3, 8.2244202495e-3, 7.5227199122e-3, 2.9215801042e-3, -1.3542800443e-3],
                [-8.7009997515e-5, -1.3542800443e-3, -1.6012600390e-3, -5.0337001448e-4, 2.5240099058e-3, -5.0337001448e-4, -1.6012600390e-3, -1.3542800443e-3, -8.7009997515e-5]]))
    filters['lofilt'] = (
        np.array([[-4.3500000174e-5, 1.2078000145e-4, -6.7714002216e-4, -1.2434000382e-4, -8.0063997302e-4, -1.5970399836e-3, -2.5168000138e-4, -4.2019999819e-4, 1.2619999470e-3, -4.2019999819e-4, -2.5168000138e-4, -1.5970399836e-3, -8.0063997302e-4, -1.2434000382e-4, -6.7714002216e-4, 1.2078000145e-4, -4.3500000174e-5],
                [1.2078000145e-4, 4.4606000301e-4, -5.8146001538e-4, 5.6215998484e-4, -1.3688000035e-4, 2.3255399428e-3, 2.8898599558e-3, 4.2872801423e-3, 5.5893999524e-3, 4.2872801423e-3, 2.8898599558e-3, 2.3255399428e-3, -1.3688000035e-4, 5.6215998484e-4, -5.8146001538e-4, 4.4606000301e-4, 1.2078000145e-4],
                [-6.7714002216e-4, -5.8146001538e-4, 1.4607800404e-3, 2.1605400834e-3, 3.7613599561e-3, 3.0809799209e-3, 4.1121998802e-3, 2.2212199401e-3, 5.5381999118e-4, 2.2212199401e-3, 4.1121998802e-3, 3.0809799209e-3, 3.7613599561e-3, 2.1605400834e-3, 1.4607800404e-3, -5.8146001538e-4, -6.7714002216e-4],
                [-1.2434000382e-4, 5.6215998484e-4, 2.1605400834e-3, 3.1757799443e-3, 3.1846798956e-3, -1.7774800071e-3, -7.4316998944e-3, -9.0569201857e-3, -9.6372198313e-3, -9.0569201857e-3, -7.4316998944e-3, -1.7774800071e-3, 3.1846798956e-3, 3.1757799443e-3, 2.1605400834e-3, 5.6215998484e-4, -1.2434000382e-4],
                [-8.0063997302e-4, -1.3688000035e-4, 3.7613599561e-3, 3.1846798956e-3, -3.5306399222e-3, -1.2604200281e-2, -1.8847439438e-2, -1.7508180812e-2, -1.6485679895e-2, -1.7508180812e-2, -1.8847439438e-2, -1.2604200281e-2, -3.5306399222e-3, 3.1846798956e-3, 3.7613599561e-3, -1.3688000035e-4, -8.0063997302e-4],
                [-1.5970399836e-3, 2.3255399428e-3, 3.0809799209e-3, -1.7774800071e-3, -1.2604200281e-2, -2.0229380578e-2, -1.1091699824e-2, 3.9556599222e-3, 1.4385120012e-2, 3.9556599222e-3, -1.1091699824e-2, -2.0229380578e-2, -1.2604200281e-2, -1.7774800071e-3, 3.0809799209e-3, 2.3255399428e-3, -1.5970399836e-3],
                [-2.5168000138e-4, 2.8898599558e-3, 4.1121998802e-3, -7.4316998944e-3, -1.8847439438e-2, -1.1091699824e-2, 2.1906599402e-2, 6.8065837026e-2, 9.0580143034e-2, 6.8065837026e-2, 2.1906599402e-2, -1.1091699824e-2, -1.8847439438e-2, -7.4316998944e-3, 4.1121998802e-3, 2.8898599558e-3, -2.5168000138e-4],
                [-4.2019999819e-4, 4.2872801423e-3, 2.2212199401e-3, -9.0569201857e-3, -1.7508180812e-2, 3.9556599222e-3, 6.8065837026e-2, 0.1445499808, 0.1773651242, 0.1445499808, 6.8065837026e-2, 3.9556599222e-3, -1.7508180812e-2, -9.0569201857e-3, 2.2212199401e-3, 4.2872801423e-3, -4.2019999819e-4],
                [1.2619999470e-3, 5.5893999524e-3, 5.5381999118e-4, -9.6372198313e-3, -1.6485679895e-2, 1.4385120012e-2, 9.0580143034e-2, 0.1773651242, 0.2120374441, 0.1773651242, 9.0580143034e-2, 1.4385120012e-2, -1.6485679895e-2, -9.6372198313e-3, 5.5381999118e-4, 5.5893999524e-3, 1.2619999470e-3],
                [-4.2019999819e-4, 4.2872801423e-3, 2.2212199401e-3, -9.0569201857e-3, -1.7508180812e-2, 3.9556599222e-3, 6.8065837026e-2, 0.1445499808, 0.1773651242, 0.1445499808, 6.8065837026e-2, 3.9556599222e-3, -1.7508180812e-2, -9.0569201857e-3, 2.2212199401e-3, 4.2872801423e-3, -4.2019999819e-4],
                [-2.5168000138e-4, 2.8898599558e-3, 4.1121998802e-3, -7.4316998944e-3, -1.8847439438e-2, -1.1091699824e-2, 2.1906599402e-2, 6.8065837026e-2, 9.0580143034e-2, 6.8065837026e-2, 2.1906599402e-2, -1.1091699824e-2, -1.8847439438e-2, -7.4316998944e-3, 4.1121998802e-3, 2.8898599558e-3, -2.5168000138e-4],
                [-1.5970399836e-3, 2.3255399428e-3, 3.0809799209e-3, -1.7774800071e-3, -1.2604200281e-2, -2.0229380578e-2, -1.1091699824e-2, 3.9556599222e-3, 1.4385120012e-2, 3.9556599222e-3, -1.1091699824e-2, -2.0229380578e-2, -1.2604200281e-2, -1.7774800071e-3, 3.0809799209e-3, 2.3255399428e-3, -1.5970399836e-3],
                [-8.0063997302e-4, -1.3688000035e-4, 3.7613599561e-3, 3.1846798956e-3, -3.5306399222e-3, -1.2604200281e-2, -1.8847439438e-2, -1.7508180812e-2, -1.6485679895e-2, -1.7508180812e-2, -1.8847439438e-2, -1.2604200281e-2, -3.5306399222e-3, 3.1846798956e-3, 3.7613599561e-3, -1.3688000035e-4, -8.0063997302e-4],
                [-1.2434000382e-4, 5.6215998484e-4, 2.1605400834e-3, 3.1757799443e-3, 3.1846798956e-3, -1.7774800071e-3, -7.4316998944e-3, -9.0569201857e-3, -9.6372198313e-3, -9.0569201857e-3, -7.4316998944e-3, -1.7774800071e-3, 3.1846798956e-3, 3.1757799443e-3, 2.1605400834e-3, 5.6215998484e-4, -1.2434000382e-4],
                [-6.7714002216e-4, -5.8146001538e-4, 1.4607800404e-3, 2.1605400834e-3, 3.7613599561e-3, 3.0809799209e-3, 4.1121998802e-3, 2.2212199401e-3, 5.5381999118e-4, 2.2212199401e-3, 4.1121998802e-3, 3.0809799209e-3, 3.7613599561e-3, 2.1605400834e-3, 1.4607800404e-3, -5.8146001538e-4, -6.7714002216e-4],
                [1.2078000145e-4, 4.4606000301e-4, -5.8146001538e-4, 5.6215998484e-4, -1.3688000035e-4, 2.3255399428e-3, 2.8898599558e-3, 4.2872801423e-3, 5.5893999524e-3, 4.2872801423e-3, 2.8898599558e-3, 2.3255399428e-3, -1.3688000035e-4, 5.6215998484e-4, -5.8146001538e-4, 4.4606000301e-4, 1.2078000145e-4],
                [-4.3500000174e-5, 1.2078000145e-4, -6.7714002216e-4, -1.2434000382e-4, -8.0063997302e-4, -1.5970399836e-3, -2.5168000138e-4, -4.2019999819e-4, 1.2619999470e-3, -4.2019999819e-4, -2.5168000138e-4, -1.5970399836e-3, -8.0063997302e-4, -1.2434000382e-4, -6.7714002216e-4, 1.2078000145e-4, -4.3500000174e-5]]))
    filters['bfilts'] = (
        np.array([[-8.1125000725e-4, 4.4451598078e-3, 1.2316980399e-2, 1.3955879956e-2, 1.4179450460e-2, 1.3955879956e-2, 1.2316980399e-2, 4.4451598078e-3, -8.1125000725e-4, 
                    3.9103501476e-3, 4.4565401040e-3, -5.8724298142e-3, -2.8760801069e-3, 8.5267601535e-3, -2.8760801069e-3, -5.8724298142e-3, 4.4565401040e-3, 3.9103501476e-3, 
                    1.3462699717e-3, -3.7740699481e-3, 8.2581602037e-3, 3.9442278445e-2, 5.3605638444e-2, 3.9442278445e-2, 8.2581602037e-3, -3.7740699481e-3, 1.3462699717e-3, 
                    7.4700999539e-4, -3.6522001028e-4, -2.2522680461e-2, -0.1105690673, -0.1768419296, -0.1105690673, -2.2522680461e-2, -3.6522001028e-4, 7.4700999539e-4, 
                    0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
                    -7.4700999539e-4, 3.6522001028e-4, 2.2522680461e-2, 0.1105690673, 0.1768419296, 0.1105690673, 2.2522680461e-2, 3.6522001028e-4, -7.4700999539e-4, 
                    -1.3462699717e-3, 3.7740699481e-3, -8.2581602037e-3, -3.9442278445e-2, -5.3605638444e-2, -3.9442278445e-2, -8.2581602037e-3, 3.7740699481e-3, -1.3462699717e-3, 
                    -3.9103501476e-3, -4.4565401040e-3, 5.8724298142e-3, 2.8760801069e-3, -8.5267601535e-3, 2.8760801069e-3, 5.8724298142e-3, -4.4565401040e-3, -3.9103501476e-3, 
                    8.1125000725e-4, -4.4451598078e-3, -1.2316980399e-2, -1.3955879956e-2, -1.4179450460e-2, -1.3955879956e-2, -1.2316980399e-2, -4.4451598078e-3, 8.1125000725e-4],
                    [0.0000000000, -8.2846998703e-4, -5.7109999034e-5, 4.0110000555e-5, 4.6670897864e-3, 8.0871898681e-3, 1.4807609841e-2, 8.6204400286e-3, -3.1221499667e-3, 
                    8.2846998703e-4, 0.0000000000, -9.7479997203e-4, -6.9718998857e-3, -2.0865600090e-3, 2.3298799060e-3, -4.4814897701e-3, 1.4917500317e-2, 8.6204400286e-3, 
                    5.7109999034e-5, 9.7479997203e-4, 0.0000000000, -1.2145539746e-2, -2.4427289143e-2, 5.0797060132e-2, 3.2785870135e-2, -4.4814897701e-3, 1.4807609841e-2, 
                    -4.0110000555e-5, 6.9718998857e-3, 1.2145539746e-2, 0.0000000000, -0.1510555595, -8.2495503128e-2, 5.0797060132e-2, 2.3298799060e-3, 8.0871898681e-3, 
                    -4.6670897864e-3, 2.0865600090e-3, 2.4427289143e-2, 0.1510555595, 0.0000000000, -0.1510555595, -2.4427289143e-2, -2.0865600090e-3, 4.6670897864e-3, 
                    -8.0871898681e-3, -2.3298799060e-3, -5.0797060132e-2, 8.2495503128e-2, 0.1510555595, 0.0000000000, -1.2145539746e-2, -6.9718998857e-3, 4.0110000555e-5, 
                    -1.4807609841e-2, 4.4814897701e-3, -3.2785870135e-2, -5.0797060132e-2, 2.4427289143e-2, 1.2145539746e-2, 0.0000000000, -9.7479997203e-4, -5.7109999034e-5, 
                    -8.6204400286e-3, -1.4917500317e-2, 4.4814897701e-3, -2.3298799060e-3, 2.0865600090e-3, 6.9718998857e-3, 9.7479997203e-4, 0.0000000000, -8.2846998703e-4, 
                    3.1221499667e-3, -8.6204400286e-3, -1.4807609841e-2, -8.0871898681e-3, -4.6670897864e-3, -4.0110000555e-5, 5.7109999034e-5, 8.2846998703e-4, 0.0000000000],
                    [8.1125000725e-4, -3.9103501476e-3, -1.3462699717e-3, -7.4700999539e-4, 0.0000000000, 7.4700999539e-4, 1.3462699717e-3, 3.9103501476e-3, -8.1125000725e-4, 
                    -4.4451598078e-3, -4.4565401040e-3, 3.7740699481e-3, 3.6522001028e-4, 0.0000000000, -3.6522001028e-4, -3.7740699481e-3, 4.4565401040e-3, 4.4451598078e-3, 
                    -1.2316980399e-2, 5.8724298142e-3, -8.2581602037e-3, 2.2522680461e-2, 0.0000000000, -2.2522680461e-2, 8.2581602037e-3, -5.8724298142e-3, 1.2316980399e-2, 
                    -1.3955879956e-2, 2.8760801069e-3, -3.9442278445e-2, 0.1105690673, 0.0000000000, -0.1105690673, 3.9442278445e-2, -2.8760801069e-3, 1.3955879956e-2, 
                    -1.4179450460e-2, -8.5267601535e-3, -5.3605638444e-2, 0.1768419296, 0.0000000000, -0.1768419296, 5.3605638444e-2, 8.5267601535e-3, 1.4179450460e-2, 
                    -1.3955879956e-2, 2.8760801069e-3, -3.9442278445e-2, 0.1105690673, 0.0000000000, -0.1105690673, 3.9442278445e-2, -2.8760801069e-3, 1.3955879956e-2, 
                    -1.2316980399e-2, 5.8724298142e-3, -8.2581602037e-3, 2.2522680461e-2, 0.0000000000, -2.2522680461e-2, 8.2581602037e-3, -5.8724298142e-3, 1.2316980399e-2, 
                    -4.4451598078e-3, -4.4565401040e-3, 3.7740699481e-3, 3.6522001028e-4, 0.0000000000, -3.6522001028e-4, -3.7740699481e-3, 4.4565401040e-3, 4.4451598078e-3, 
                    8.1125000725e-4, -3.9103501476e-3, -1.3462699717e-3, -7.4700999539e-4, 0.0000000000, 7.4700999539e-4, 1.3462699717e-3, 3.9103501476e-3, -8.1125000725e-4],
                    [3.1221499667e-3, -8.6204400286e-3, -1.4807609841e-2, -8.0871898681e-3, -4.6670897864e-3, -4.0110000555e-5, 5.7109999034e-5, 8.2846998703e-4, 0.0000000000, 
                    -8.6204400286e-3, -1.4917500317e-2, 4.4814897701e-3, -2.3298799060e-3, 2.0865600090e-3, 6.9718998857e-3, 9.7479997203e-4, -0.0000000000, -8.2846998703e-4, 
                    -1.4807609841e-2, 4.4814897701e-3, -3.2785870135e-2, -5.0797060132e-2, 2.4427289143e-2, 1.2145539746e-2, 0.0000000000, -9.7479997203e-4, -5.7109999034e-5, 
                    -8.0871898681e-3, -2.3298799060e-3, -5.0797060132e-2, 8.2495503128e-2, 0.1510555595, -0.0000000000, -1.2145539746e-2, -6.9718998857e-3, 4.0110000555e-5, 
                    -4.6670897864e-3, 2.0865600090e-3, 2.4427289143e-2, 0.1510555595, 0.0000000000, -0.1510555595, -2.4427289143e-2, -2.0865600090e-3, 4.6670897864e-3, 
                    -4.0110000555e-5, 6.9718998857e-3, 1.2145539746e-2, 0.0000000000, -0.1510555595, -8.2495503128e-2, 5.0797060132e-2, 2.3298799060e-3, 8.0871898681e-3, 
                    5.7109999034e-5, 9.7479997203e-4, -0.0000000000, -1.2145539746e-2, -2.4427289143e-2, 5.0797060132e-2, 3.2785870135e-2, -4.4814897701e-3, 1.4807609841e-2, 
                    8.2846998703e-4, -0.0000000000, -9.7479997203e-4, -6.9718998857e-3, -2.0865600090e-3, 2.3298799060e-3, -4.4814897701e-3, 1.4917500317e-2, 8.6204400286e-3, 
                    0.0000000000, -8.2846998703e-4, -5.7109999034e-5, 4.0110000555e-5, 4.6670897864e-3, 8.0871898681e-3, 1.4807609841e-2, 8.6204400286e-3, -3.1221499667e-3]]).T)
    return filters

def sp0_filters():
    filters = {}
    filters['harmonics'] = np.array([0])
    filters['lo0filt'] = (
        np.array([[-4.514000e-04, -1.137100e-04, -3.725800e-04, -3.743860e-03,
                   -3.725800e-04, -1.137100e-04, -4.514000e-04],
                  [-1.137100e-04, -6.119520e-03, -1.344160e-02, -7.563200e-03,
                   -1.344160e-02, -6.119520e-03, -1.137100e-04],
                  [-3.725800e-04, -1.344160e-02, 6.441488e-02, 1.524935e-01,
                   6.441488e-02, -1.344160e-02, -3.725800e-04],
                  [-3.743860e-03, -7.563200e-03, 1.524935e-01, 3.153017e-01,
                   1.524935e-01, -7.563200e-03, -3.743860e-03],
                  [-3.725800e-04, -1.344160e-02, 6.441488e-02, 1.524935e-01,
                   6.441488e-02, -1.344160e-02, -3.725800e-04],
                  [-1.137100e-04, -6.119520e-03, -1.344160e-02, -7.563200e-03,
                   -1.344160e-02, -6.119520e-03, -1.137100e-04],
                  [-4.514000e-04, -1.137100e-04, -3.725800e-04, -3.743860e-03,
                   -3.725800e-04, -1.137100e-04, -4.514000e-04]]))
    filters['lofilt'] = (
        np.array([[-2.257000e-04, -8.064400e-04, -5.686000e-05, 8.741400e-04,
                   -1.862800e-04, -1.031640e-03, -1.871920e-03, -1.031640e-03,
                   -1.862800e-04, 8.741400e-04, -5.686000e-05, -8.064400e-04,
                   -2.257000e-04],
                  [-8.064400e-04, 1.417620e-03, -1.903800e-04, -2.449060e-03,
                   -4.596420e-03, -7.006740e-03, -6.948900e-03, -7.006740e-03,
                   -4.596420e-03, -2.449060e-03, -1.903800e-04, 1.417620e-03,
                   -8.064400e-04],
                  [-5.686000e-05, -1.903800e-04, -3.059760e-03, -6.401000e-03,
                   -6.720800e-03, -5.236180e-03, -3.781600e-03, -5.236180e-03,
                   -6.720800e-03, -6.401000e-03, -3.059760e-03, -1.903800e-04,
                   -5.686000e-05],
                  [8.741400e-04, -2.449060e-03, -6.401000e-03, -5.260020e-03,
                   3.938620e-03, 1.722078e-02, 2.449600e-02, 1.722078e-02,
                   3.938620e-03, -5.260020e-03, -6.401000e-03, -2.449060e-03,
                   8.741400e-04],
                  [-1.862800e-04, -4.596420e-03, -6.720800e-03, 3.938620e-03,
                   3.220744e-02, 6.306262e-02, 7.624674e-02, 6.306262e-02,
                   3.220744e-02, 3.938620e-03, -6.720800e-03, -4.596420e-03,
                   -1.862800e-04],
                  [-1.031640e-03, -7.006740e-03, -5.236180e-03, 1.722078e-02,
                   6.306262e-02, 1.116388e-01, 1.348999e-01, 1.116388e-01,
                   6.306262e-02, 1.722078e-02, -5.236180e-03, -7.006740e-03,
                   -1.031640e-03],
                  [-1.871920e-03, -6.948900e-03, -3.781600e-03, 2.449600e-02,
                   7.624674e-02, 1.348999e-01, 1.576508e-01, 1.348999e-01,
                   7.624674e-02, 2.449600e-02, -3.781600e-03, -6.948900e-03,
                   -1.871920e-03],
                  [-1.031640e-03, -7.006740e-03, -5.236180e-03, 1.722078e-02,
                   6.306262e-02, 1.116388e-01, 1.348999e-01, 1.116388e-01,
                   6.306262e-02, 1.722078e-02, -5.236180e-03, -7.006740e-03,
                   -1.031640e-03],
                  [-1.862800e-04, -4.596420e-03, -6.720800e-03, 3.938620e-03,
                   3.220744e-02, 6.306262e-02, 7.624674e-02, 6.306262e-02,
                   3.220744e-02, 3.938620e-03, -6.720800e-03, -4.596420e-03,
                   -1.862800e-04],
                  [8.741400e-04, -2.449060e-03, -6.401000e-03, -5.260020e-03,
                   3.938620e-03, 1.722078e-02, 2.449600e-02, 1.722078e-02,
                   3.938620e-03, -5.260020e-03, -6.401000e-03, -2.449060e-03,
                   8.741400e-04],
                  [-5.686000e-05, -1.903800e-04, -3.059760e-03, -6.401000e-03,
                   -6.720800e-03, -5.236180e-03, -3.781600e-03, -5.236180e-03,
                   -6.720800e-03, -6.401000e-03, -3.059760e-03, -1.903800e-04,
                   -5.686000e-05],
                  [-8.064400e-04, 1.417620e-03, -1.903800e-04, -2.449060e-03,
                   -4.596420e-03, -7.006740e-03, -6.948900e-03, -7.006740e-03,
                   -4.596420e-03, -2.449060e-03, -1.903800e-04, 1.417620e-03,
                   -8.064400e-04],
                  [-2.257000e-04, -8.064400e-04, -5.686000e-05, 8.741400e-04,
                   -1.862800e-04, -1.031640e-03, -1.871920e-03, -1.031640e-03,
                   -1.862800e-04, 8.741400e-04, -5.686000e-05, -8.064400e-04,
                   -2.257000e-04]]))
    filters['mtx'] = np.array([1.000000])
    filters['hi0filt'] = (
        np.array([[5.997200e-04, -6.068000e-05, -3.324900e-04, -3.325600e-04,
                   -2.406600e-04, -3.325600e-04, -3.324900e-04, -6.068000e-05,
                   5.997200e-04],
                  [-6.068000e-05, 1.263100e-04, 4.927100e-04, 1.459700e-04,
                   -3.732100e-04, 1.459700e-04, 4.927100e-04, 1.263100e-04,
                   -6.068000e-05],
                  [-3.324900e-04, 4.927100e-04, -1.616650e-03, -1.437358e-02,
                   -2.420138e-02, -1.437358e-02, -1.616650e-03, 4.927100e-04,
                   -3.324900e-04],
                  [-3.325600e-04, 1.459700e-04, -1.437358e-02, -6.300923e-02,
                   -9.623594e-02, -6.300923e-02, -1.437358e-02, 1.459700e-04,
                   -3.325600e-04],
                  [-2.406600e-04, -3.732100e-04, -2.420138e-02, -9.623594e-02,
                   8.554893e-01, -9.623594e-02, -2.420138e-02, -3.732100e-04,
                   -2.406600e-04],
                  [-3.325600e-04, 1.459700e-04, -1.437358e-02, -6.300923e-02,
                   -9.623594e-02, -6.300923e-02, -1.437358e-02, 1.459700e-04,
                   -3.325600e-04],
                  [-3.324900e-04, 4.927100e-04, -1.616650e-03, -1.437358e-02,
                   -2.420138e-02, -1.437358e-02, -1.616650e-03, 4.927100e-04,
                   -3.324900e-04],
                  [-6.068000e-05, 1.263100e-04, 4.927100e-04, 1.459700e-04,
                   -3.732100e-04, 1.459700e-04, 4.927100e-04, 1.263100e-04,
                   -6.068000e-05],
                  [5.997200e-04, -6.068000e-05, -3.324900e-04, -3.325600e-04,
                   -2.406600e-04, -3.325600e-04, -3.324900e-04, -6.068000e-05,
                   5.997200e-04]]))
    filters['bfilts'] = (
        np.array([-9.066000e-05, -1.738640e-03, -4.942500e-03, -7.889390e-03,
                  -1.009473e-02, -7.889390e-03, -4.942500e-03, -1.738640e-03,
                  -9.066000e-05, -1.738640e-03, -4.625150e-03, -7.272540e-03,
                  -7.623410e-03, -9.091950e-03, -7.623410e-03, -7.272540e-03,
                  -4.625150e-03, -1.738640e-03, -4.942500e-03, -7.272540e-03,
                  -2.129540e-02, -2.435662e-02, -3.487008e-02, -2.435662e-02,
                  -2.129540e-02, -7.272540e-03, -4.942500e-03, -7.889390e-03,
                  -7.623410e-03, -2.435662e-02, -1.730466e-02, -3.158605e-02,
                  -1.730466e-02, -2.435662e-02, -7.623410e-03, -7.889390e-03,
                  -1.009473e-02, -9.091950e-03, -3.487008e-02, -3.158605e-02,
                  9.464195e-01, -3.158605e-02, -3.487008e-02, -9.091950e-03,
                  -1.009473e-02, -7.889390e-03, -7.623410e-03, -2.435662e-02,
                  -1.730466e-02, -3.158605e-02, -1.730466e-02, -2.435662e-02,
                  -7.623410e-03, -7.889390e-03, -4.942500e-03, -7.272540e-03,
                  -2.129540e-02, -2.435662e-02, -3.487008e-02, -2.435662e-02,
                  -2.129540e-02, -7.272540e-03, -4.942500e-03, -1.738640e-03,
                  -4.625150e-03, -7.272540e-03, -7.623410e-03, -9.091950e-03,
                  -7.623410e-03, -7.272540e-03, -4.625150e-03, -1.738640e-03,
                  -9.066000e-05, -1.738640e-03, -4.942500e-03, -7.889390e-03,
                  -1.009473e-02, -7.889390e-03, -4.942500e-03, -1.738640e-03,
                  -9.066000e-05]))
    filters['bfilts'] = filters['bfilts'].reshape(len(filters['bfilts']), 1)
    return filters

def sp1_filters():
    filters = {}
    filters['harmonics'] = np.array([1])
    filters['mtx'] = np.eye(2)
    filters['lo0filt'] = (
        np.array([[-8.701000e-05, -1.354280e-03, -1.601260e-03, -5.033700e-04,
                   2.524010e-03, -5.033700e-04, -1.601260e-03, -1.354280e-03,
                   -8.701000e-05],
                  [-1.354280e-03, 2.921580e-03, 7.522720e-03, 8.224420e-03,
                   1.107620e-03, 8.224420e-03, 7.522720e-03, 2.921580e-03,
                   -1.354280e-03],
                  [-1.601260e-03, 7.522720e-03, -7.061290e-03, -3.769487e-02,
                   -3.297137e-02, -3.769487e-02, -7.061290e-03, 7.522720e-03,
                   -1.601260e-03],
                  [-5.033700e-04, 8.224420e-03, -3.769487e-02, 4.381320e-02,
                   1.811603e-01, 4.381320e-02, -3.769487e-02, 8.224420e-03,
                   -5.033700e-04],
                  [2.524010e-03, 1.107620e-03, -3.297137e-02, 1.811603e-01,
                   4.376250e-01, 1.811603e-01, -3.297137e-02, 1.107620e-03,
                   2.524010e-03],
                  [-5.033700e-04, 8.224420e-03, -3.769487e-02, 4.381320e-02,
                   1.811603e-01, 4.381320e-02, -3.769487e-02, 8.224420e-03,
                   -5.033700e-04],
                  [-1.601260e-03, 7.522720e-03, -7.061290e-03, -3.769487e-02,
                   -3.297137e-02, -3.769487e-02, -7.061290e-03, 7.522720e-03,
                   -1.601260e-03],
                  [-1.354280e-03, 2.921580e-03, 7.522720e-03, 8.224420e-03,
                   1.107620e-03, 8.224420e-03, 7.522720e-03, 2.921580e-03,
                   -1.354280e-03],
                  [-8.701000e-05, -1.354280e-03, -1.601260e-03, -5.033700e-04,
                   2.524010e-03, -5.033700e-04, -1.601260e-03, -1.354280e-03,
                   -8.701000e-05]]))
    filters['lofilt'] = (
        np.array([[-4.350000e-05, 1.207800e-04, -6.771400e-04, -1.243400e-04,
                   -8.006400e-04, -1.597040e-03, -2.516800e-04, -4.202000e-04,
                   1.262000e-03, -4.202000e-04, -2.516800e-04, -1.597040e-03,
                   -8.006400e-04, -1.243400e-04, -6.771400e-04, 1.207800e-04,
                   -4.350000e-05],
                  [1.207800e-04, 4.460600e-04, -5.814600e-04, 5.621600e-04,
                   -1.368800e-04, 2.325540e-03, 2.889860e-03, 4.287280e-03,
                   5.589400e-03, 4.287280e-03, 2.889860e-03, 2.325540e-03,
                   -1.368800e-04, 5.621600e-04, -5.814600e-04, 4.460600e-04,
                   1.207800e-04],
                  [-6.771400e-04, -5.814600e-04, 1.460780e-03, 2.160540e-03,
                   3.761360e-03, 3.080980e-03, 4.112200e-03, 2.221220e-03,
                   5.538200e-04, 2.221220e-03, 4.112200e-03, 3.080980e-03,
                   3.761360e-03, 2.160540e-03, 1.460780e-03, -5.814600e-04,
                   -6.771400e-04],
                  [-1.243400e-04, 5.621600e-04, 2.160540e-03, 3.175780e-03,
                   3.184680e-03, -1.777480e-03, -7.431700e-03, -9.056920e-03,
                   -9.637220e-03, -9.056920e-03, -7.431700e-03, -1.777480e-03,
                   3.184680e-03, 3.175780e-03, 2.160540e-03, 5.621600e-04,
                   -1.243400e-04],
                  [-8.006400e-04, -1.368800e-04, 3.761360e-03, 3.184680e-03,
                   -3.530640e-03, -1.260420e-02, -1.884744e-02, -1.750818e-02,
                   -1.648568e-02, -1.750818e-02, -1.884744e-02, -1.260420e-02,
                   -3.530640e-03, 3.184680e-03, 3.761360e-03, -1.368800e-04,
                   -8.006400e-04],
                  [-1.597040e-03, 2.325540e-03, 3.080980e-03, -1.777480e-03,
                   -1.260420e-02, -2.022938e-02, -1.109170e-02, 3.955660e-03,
                   1.438512e-02, 3.955660e-03, -1.109170e-02, -2.022938e-02,
                   -1.260420e-02, -1.777480e-03, 3.080980e-03, 2.325540e-03,
                   -1.597040e-03],
                  [-2.516800e-04, 2.889860e-03, 4.112200e-03, -7.431700e-03,
                   -1.884744e-02, -1.109170e-02, 2.190660e-02, 6.806584e-02,
                   9.058014e-02, 6.806584e-02, 2.190660e-02, -1.109170e-02,
                   -1.884744e-02, -7.431700e-03, 4.112200e-03, 2.889860e-03,
                   -2.516800e-04],
                  [-4.202000e-04, 4.287280e-03, 2.221220e-03, -9.056920e-03,
                   -1.750818e-02, 3.955660e-03, 6.806584e-02, 1.445500e-01,
                   1.773651e-01, 1.445500e-01, 6.806584e-02, 3.955660e-03,
                   -1.750818e-02, -9.056920e-03, 2.221220e-03, 4.287280e-03,
                   -4.202000e-04],
                  [1.262000e-03, 5.589400e-03, 5.538200e-04, -9.637220e-03,
                   -1.648568e-02, 1.438512e-02, 9.058014e-02, 1.773651e-01,
                   2.120374e-01, 1.773651e-01, 9.058014e-02, 1.438512e-02,
                   -1.648568e-02, -9.637220e-03, 5.538200e-04, 5.589400e-03,
                   1.262000e-03],
                  [-4.202000e-04, 4.287280e-03, 2.221220e-03, -9.056920e-03,
                   -1.750818e-02, 3.955660e-03, 6.806584e-02, 1.445500e-01,
                   1.773651e-01, 1.445500e-01, 6.806584e-02, 3.955660e-03,
                   -1.750818e-02, -9.056920e-03, 2.221220e-03, 4.287280e-03,
                   -4.202000e-04],
                  [-2.516800e-04, 2.889860e-03, 4.112200e-03, -7.431700e-03,
                   -1.884744e-02, -1.109170e-02, 2.190660e-02, 6.806584e-02,
                   9.058014e-02, 6.806584e-02, 2.190660e-02, -1.109170e-02,
                   -1.884744e-02, -7.431700e-03, 4.112200e-03, 2.889860e-03,
                   -2.516800e-04],
                  [-1.597040e-03, 2.325540e-03, 3.080980e-03, -1.777480e-03,
                   -1.260420e-02, -2.022938e-02, -1.109170e-02, 3.955660e-03,
                   1.438512e-02, 3.955660e-03, -1.109170e-02, -2.022938e-02,
                   -1.260420e-02, -1.777480e-03, 3.080980e-03, 2.325540e-03,
                   -1.597040e-03],
                  [-8.006400e-04, -1.368800e-04, 3.761360e-03, 3.184680e-03,
                   -3.530640e-03, -1.260420e-02, -1.884744e-02, -1.750818e-02,
                   -1.648568e-02, -1.750818e-02, -1.884744e-02, -1.260420e-02,
                   -3.530640e-03, 3.184680e-03, 3.761360e-03, -1.368800e-04,
                   -8.006400e-04],
                  [-1.243400e-04, 5.621600e-04, 2.160540e-03, 3.175780e-03,
                   3.184680e-03, -1.777480e-03, -7.431700e-03, -9.056920e-03,
                   -9.637220e-03, -9.056920e-03, -7.431700e-03, -1.777480e-03,
                   3.184680e-03, 3.175780e-03, 2.160540e-03, 5.621600e-04,
                   -1.243400e-04],
                  [-6.771400e-04, -5.814600e-04, 1.460780e-03, 2.160540e-03,
                   3.761360e-03, 3.080980e-03, 4.112200e-03, 2.221220e-03,
                   5.538200e-04, 2.221220e-03, 4.112200e-03, 3.080980e-03,
                   3.761360e-03, 2.160540e-03, 1.460780e-03, -5.814600e-04,
                   -6.771400e-04],
                  [1.207800e-04, 4.460600e-04, -5.814600e-04, 5.621600e-04,
                   -1.368800e-04, 2.325540e-03, 2.889860e-03, 4.287280e-03,
                   5.589400e-03, 4.287280e-03, 2.889860e-03, 2.325540e-03,
                   -1.368800e-04, 5.621600e-04, -5.814600e-04, 4.460600e-04,
                   1.207800e-04],
                  [-4.350000e-05, 1.207800e-04, -6.771400e-04, -1.243400e-04,
                   -8.006400e-04, -1.597040e-03, -2.516800e-04, -4.202000e-04,
                   1.262000e-03, -4.202000e-04, -2.516800e-04, -1.597040e-03,
                   -8.006400e-04, -1.243400e-04, -6.771400e-04, 1.207800e-04,
                   -4.350000e-05]]))
    filters['hi0filt'] = (
        np.array([[-9.570000e-04, -2.424100e-04, -1.424720e-03, -8.742600e-04,
                   -1.166810e-03, -8.742600e-04, -1.424720e-03, -2.424100e-04,
                   -9.570000e-04],
                  [-2.424100e-04, -4.317530e-03, 8.998600e-04, 9.156420e-03,
                   1.098012e-02, 9.156420e-03, 8.998600e-04, -4.317530e-03,
                   -2.424100e-04],
                  [-1.424720e-03, 8.998600e-04, 1.706347e-02, 1.094866e-02,
                   -5.897780e-03, 1.094866e-02, 1.706347e-02, 8.998600e-04,
                   -1.424720e-03],
                  [-8.742600e-04, 9.156420e-03, 1.094866e-02, -7.841370e-02,
                   -1.562827e-01, -7.841370e-02, 1.094866e-02, 9.156420e-03,
                   -8.742600e-04],
                  [-1.166810e-03, 1.098012e-02, -5.897780e-03, -1.562827e-01,
                   7.282593e-01, -1.562827e-01, -5.897780e-03, 1.098012e-02,
                   -1.166810e-03],
                  [-8.742600e-04, 9.156420e-03, 1.094866e-02, -7.841370e-02,
                   -1.562827e-01, -7.841370e-02, 1.094866e-02, 9.156420e-03,
                   -8.742600e-04],
                  [-1.424720e-03, 8.998600e-04, 1.706347e-02, 1.094866e-02,
                   -5.897780e-03, 1.094866e-02, 1.706347e-02, 8.998600e-04,
                   -1.424720e-03],
                  [-2.424100e-04, -4.317530e-03, 8.998600e-04, 9.156420e-03,
                   1.098012e-02, 9.156420e-03, 8.998600e-04, -4.317530e-03,
                   -2.424100e-04],
                  [-9.570000e-04, -2.424100e-04, -1.424720e-03, -8.742600e-04,
                   -1.166810e-03, -8.742600e-04, -1.424720e-03, -2.424100e-04,
                   -9.570000e-04]]))
    filters['bfilts'] = (
        np.array([[6.125880e-03, -8.052600e-03, -2.103714e-02, -1.536890e-02,
                   -1.851466e-02, -1.536890e-02, -2.103714e-02, -8.052600e-03,
                   6.125880e-03, -1.287416e-02, -9.611520e-03, 1.023569e-02,
                   6.009450e-03, 1.872620e-03, 6.009450e-03, 1.023569e-02,
                   -9.611520e-03, -1.287416e-02, -5.641530e-03, 4.168400e-03,
                   -2.382180e-02, -5.375324e-02, -2.076086e-02, -5.375324e-02,
                   -2.382180e-02, 4.168400e-03, -5.641530e-03, -8.957260e-03,
                   -1.751170e-03, -1.836909e-02, 1.265655e-01, 2.996168e-01,
                   1.265655e-01, -1.836909e-02, -1.751170e-03, -8.957260e-03,
                   0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
                   0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00,
                   0.000000e+00, 8.957260e-03, 1.751170e-03, 1.836909e-02,
                   -1.265655e-01, -2.996168e-01, -1.265655e-01, 1.836909e-02,
                   1.751170e-03, 8.957260e-03, 5.641530e-03, -4.168400e-03,
                   2.382180e-02, 5.375324e-02, 2.076086e-02, 5.375324e-02,
                   2.382180e-02, -4.168400e-03, 5.641530e-03, 1.287416e-02,
                   9.611520e-03, -1.023569e-02, -6.009450e-03, -1.872620e-03,
                   -6.009450e-03, -1.023569e-02, 9.611520e-03, 1.287416e-02,
                   -6.125880e-03, 8.052600e-03, 2.103714e-02, 1.536890e-02,
                   1.851466e-02, 1.536890e-02, 2.103714e-02, 8.052600e-03,
                   -6.125880e-03],
                  [-6.125880e-03, 1.287416e-02, 5.641530e-03, 8.957260e-03,
                   0.000000e+00, -8.957260e-03, -5.641530e-03, -1.287416e-02,
                   6.125880e-03, 8.052600e-03, 9.611520e-03, -4.168400e-03,
                   1.751170e-03, 0.000000e+00, -1.751170e-03, 4.168400e-03,
                   -9.611520e-03, -8.052600e-03, 2.103714e-02, -1.023569e-02,
                   2.382180e-02, 1.836909e-02, 0.000000e+00, -1.836909e-02,
                   -2.382180e-02, 1.023569e-02, -2.103714e-02, 1.536890e-02,
                   -6.009450e-03, 5.375324e-02, -1.265655e-01, 0.000000e+00,
                   1.265655e-01, -5.375324e-02, 6.009450e-03, -1.536890e-02,
                   1.851466e-02, -1.872620e-03, 2.076086e-02, -2.996168e-01,
                   0.000000e+00, 2.996168e-01, -2.076086e-02, 1.872620e-03,
                   -1.851466e-02, 1.536890e-02, -6.009450e-03, 5.375324e-02,
                   -1.265655e-01, 0.000000e+00, 1.265655e-01, -5.375324e-02,
                   6.009450e-03, -1.536890e-02, 2.103714e-02, -1.023569e-02,
                   2.382180e-02, 1.836909e-02, 0.000000e+00, -1.836909e-02,
                   -2.382180e-02, 1.023569e-02, -2.103714e-02, 8.052600e-03,
                   9.611520e-03, -4.168400e-03, 1.751170e-03, 0.000000e+00,
                   -1.751170e-03, 4.168400e-03, -9.611520e-03, -8.052600e-03,
                   -6.125880e-03, 1.287416e-02, 5.641530e-03, 8.957260e-03,
                   0.000000e+00, -8.957260e-03, -5.641530e-03, -1.287416e-02,
                   6.125880e-03]]).T)
    filters['bfilts'] = np.negative(filters['bfilts'])
    return filters

def _sp0_filters():
    filters = {}
    filters['harmonics'] = np.array([0])
    filters['lo0filt'] = (
        np.array([[-4.514000e-04, -1.137100e-04, -3.725800e-04, -3.743860e-03,
                   -3.725800e-04, -1.137100e-04, -4.514000e-04],
                  [-1.137100e-04, -6.119520e-03, -1.344160e-02, -7.563200e-03,
                   -1.344160e-02, -6.119520e-03, -1.137100e-04],
                  [-3.725800e-04, -1.344160e-02, 6.441488e-02, 1.524935e-01,
                   6.441488e-02, -1.344160e-02, -3.725800e-04],
                  [-3.743860e-03, -7.563200e-03, 1.524935e-01, 3.153017e-01,
                   1.524935e-01, -7.563200e-03, -3.743860e-03],
                  [-3.725800e-04, -1.344160e-02, 6.441488e-02, 1.524935e-01,
                   6.441488e-02, -1.344160e-02, -3.725800e-04],
                  [-1.137100e-04, -6.119520e-03, -1.344160e-02, -7.563200e-03,
                   -1.344160e-02, -6.119520e-03, -1.137100e-04],
                  [-4.514000e-04, -1.137100e-04, -3.725800e-04, -3.743860e-03,
                   -3.725800e-04, -1.137100e-04, -4.514000e-04]]))
    filters['lofilt'] = (
        np.array([[-2.257000e-04, -8.064400e-04, -5.686000e-05, 8.741400e-04,
                   -1.862800e-04, -1.031640e-03, -1.871920e-03, -1.031640e-03,
                   -1.862800e-04, 8.741400e-04, -5.686000e-05, -8.064400e-04,
                   -2.257000e-04],
                  [-8.064400e-04, 1.417620e-03, -1.903800e-04, -2.449060e-03,
                   -4.596420e-03, -7.006740e-03, -6.948900e-03, -7.006740e-03,
                   -4.596420e-03, -2.449060e-03, -1.903800e-04, 1.417620e-03,
                   -8.064400e-04],
                  [-5.686000e-05, -1.903800e-04, -3.059760e-03, -6.401000e-03,
                   -6.720800e-03, -5.236180e-03, -3.781600e-03, -5.236180e-03,
                   -6.720800e-03, -6.401000e-03, -3.059760e-03, -1.903800e-04,
                   -5.686000e-05],
                  [8.741400e-04, -2.449060e-03, -6.401000e-03, -5.260020e-03,
                   3.938620e-03, 1.722078e-02, 2.449600e-02, 1.722078e-02,
                   3.938620e-03, -5.260020e-03, -6.401000e-03, -2.449060e-03,
                   8.741400e-04],
                  [-1.862800e-04, -4.596420e-03, -6.720800e-03, 3.938620e-03,
                   3.220744e-02, 6.306262e-02, 7.624674e-02, 6.306262e-02,
                   3.220744e-02, 3.938620e-03, -6.720800e-03, -4.596420e-03,
                   -1.862800e-04],
                  [-1.031640e-03, -7.006740e-03, -5.236180e-03, 1.722078e-02,
                   6.306262e-02, 1.116388e-01, 1.348999e-01, 1.116388e-01,
                   6.306262e-02, 1.722078e-02, -5.236180e-03, -7.006740e-03,
                   -1.031640e-03],
                  [-1.871920e-03, -6.948900e-03, -3.781600e-03, 2.449600e-02,
                   7.624674e-02, 1.348999e-01, 1.576508e-01, 1.348999e-01,
                   7.624674e-02, 2.449600e-02, -3.781600e-03, -6.948900e-03,
                   -1.871920e-03],
                  [-1.031640e-03, -7.006740e-03, -5.236180e-03, 1.722078e-02,
                   6.306262e-02, 1.116388e-01, 1.348999e-01, 1.116388e-01,
                   6.306262e-02, 1.722078e-02, -5.236180e-03, -7.006740e-03,
                   -1.031640e-03],
                  [-1.862800e-04, -4.596420e-03, -6.720800e-03, 3.938620e-03,
                   3.220744e-02, 6.306262e-02, 7.624674e-02, 6.306262e-02,
                   3.220744e-02, 3.938620e-03, -6.720800e-03, -4.596420e-03,
                   -1.862800e-04],
                  [8.741400e-04, -2.449060e-03, -6.401000e-03, -5.260020e-03,
                   3.938620e-03, 1.722078e-02, 2.449600e-02, 1.722078e-02,
                   3.938620e-03, -5.260020e-03, -6.401000e-03, -2.449060e-03,
                   8.741400e-04],
                  [-5.686000e-05, -1.903800e-04, -3.059760e-03, -6.401000e-03,
                   -6.720800e-03, -5.236180e-03, -3.781600e-03, -5.236180e-03,
                   -6.720800e-03, -6.401000e-03, -3.059760e-03, -1.903800e-04,
                   -5.686000e-05],
                  [-8.064400e-04, 1.417620e-03, -1.903800e-04, -2.449060e-03,
                   -4.596420e-03, -7.006740e-03, -6.948900e-03, -7.006740e-03,
                   -4.596420e-03, -2.449060e-03, -1.903800e-04, 1.417620e-03,
                   -8.064400e-04],
                  [-2.257000e-04, -8.064400e-04, -5.686000e-05, 8.741400e-04,
                   -1.862800e-04, -1.031640e-03, -1.871920e-03, -1.031640e-03,
                   -1.862800e-04, 8.741400e-04, -5.686000e-05, -8.064400e-04,
                   -2.257000e-04]]))
    filters['mtx'] = np.array([1.000000])
    filters['hi0filt'] = (
        np.array([[5.997200e-04, -6.068000e-05, -3.324900e-04, -3.325600e-04,
                   -2.406600e-04, -3.325600e-04, -3.324900e-04, -6.068000e-05,
                   5.997200e-04],
                  [-6.068000e-05, 1.263100e-04, 4.927100e-04, 1.459700e-04,
                   -3.732100e-04, 1.459700e-04, 4.927100e-04, 1.263100e-04,
                   -6.068000e-05],
                  [-3.324900e-04, 4.927100e-04, -1.616650e-03, -1.437358e-02,
                   -2.420138e-02, -1.437358e-02, -1.616650e-03, 4.927100e-04,
                   -3.324900e-04],
                  [-3.325600e-04, 1.459700e-04, -1.437358e-02, -6.300923e-02,
                   -9.623594e-02, -6.300923e-02, -1.437358e-02, 1.459700e-04,
                   -3.325600e-04],
                  [-2.406600e-04, -3.732100e-04, -2.420138e-02, -9.623594e-02,
                   8.554893e-01, -9.623594e-02, -2.420138e-02, -3.732100e-04,
                   -2.406600e-04],
                  [-3.325600e-04, 1.459700e-04, -1.437358e-02, -6.300923e-02,
                   -9.623594e-02, -6.300923e-02, -1.437358e-02, 1.459700e-04,
                   -3.325600e-04],
                  [-3.324900e-04, 4.927100e-04, -1.616650e-03, -1.437358e-02,
                   -2.420138e-02, -1.437358e-02, -1.616650e-03, 4.927100e-04,
                   -3.324900e-04],
                  [-6.068000e-05, 1.263100e-04, 4.927100e-04, 1.459700e-04,
                   -3.732100e-04, 1.459700e-04, 4.927100e-04, 1.263100e-04,
                   -6.068000e-05],
                  [5.997200e-04, -6.068000e-05, -3.324900e-04, -3.325600e-04,
                   -2.406600e-04, -3.325600e-04, -3.324900e-04, -6.068000e-05,
                   5.997200e-04]]))
    filters['bfilts'] = (
        np.array([-9.066000e-05, -1.738640e-03, -4.942500e-03, -7.889390e-03,
                  -1.009473e-02, -7.889390e-03, -4.942500e-03, -1.738640e-03,
                  -9.066000e-05, -1.738640e-03, -4.625150e-03, -7.272540e-03,
                  -7.623410e-03, -9.091950e-03, -7.623410e-03, -7.272540e-03,
                  -4.625150e-03, -1.738640e-03, -4.942500e-03, -7.272540e-03,
                  -2.129540e-02, -2.435662e-02, -3.487008e-02, -2.435662e-02,
                  -2.129540e-02, -7.272540e-03, -4.942500e-03, -7.889390e-03,
                  -7.623410e-03, -2.435662e-02, -1.730466e-02, -3.158605e-02,
                  -1.730466e-02, -2.435662e-02, -7.623410e-03, -7.889390e-03,
                  -1.009473e-02, -9.091950e-03, -3.487008e-02, -3.158605e-02,
                  9.464195e-01, -3.158605e-02, -3.487008e-02, -9.091950e-03,
                  -1.009473e-02, -7.889390e-03, -7.623410e-03, -2.435662e-02,
                  -1.730466e-02, -3.158605e-02, -1.730466e-02, -2.435662e-02,
                  -7.623410e-03, -7.889390e-03, -4.942500e-03, -7.272540e-03,
                  -2.129540e-02, -2.435662e-02, -3.487008e-02, -2.435662e-02,
                  -2.129540e-02, -7.272540e-03, -4.942500e-03, -1.738640e-03,
                  -4.625150e-03, -7.272540e-03, -7.623410e-03, -9.091950e-03,
                  -7.623410e-03, -7.272540e-03, -4.625150e-03, -1.738640e-03,
                  -9.066000e-05, -1.738640e-03, -4.942500e-03, -7.889390e-03,
                  -1.009473e-02, -7.889390e-03, -4.942500e-03, -1.738640e-03,
                  -9.066000e-05]))
    filters['bfilts'] = filters['bfilts'].reshape(len(filters['bfilts']), 1)
    return filters